import{g as c,B as b,q as i,j as e}from"./index-ChZqENbQ.js";const j=({isOpen:d,onClose:n,onSave:x,editingProduct:r})=>{const[p,u]=c.useState([]),{register:t,handleSubmit:m,reset:o,formState:{errors:s}}=b();c.useEffect(()=>{d&&(i.get("/api/categories").then(a=>u(a.data)),r?o(r):o())},[d,r,o]);const l=async a=>{try{r?await i.put(`/api/products/${r.id}`,a):await i.post("/api/products",a),x(),n()}catch(h){console.error("Error saving product:",h)}};return d?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-xl",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Edit Product":"Add New Product"}),e.jsxs("form",{onSubmit:m(l),className:"space-y-4",children:[e.jsx("input",{placeholder:"Product Name",...t("name",{required:"Name is required"}),className:"w-full border p-2"}),s.name&&e.jsx("p",{className:"text-red-500",children:s.name.message}),e.jsx("textarea",{placeholder:"Description",...t("description"),className:"w-full border p-2"}),e.jsx("input",{placeholder:"Price",type:"number",...t("price",{required:"Price is required"}),className:"w-full border p-2"}),s.price&&e.jsx("p",{className:"text-red-500",children:s.price.message}),e.jsx("input",{placeholder:"Image URL",...t("imageUrl"),className:"w-full border p-2"}),e.jsxs("select",{...t("categoryId",{required:"Category is required"}),className:"w-full border p-2",children:[e.jsx("option",{value:"",children:"Select Category"}),p.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),s.categoryId&&e.jsx("p",{className:"text-red-500",children:s.categoryId.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:r?"Update":"Create"})]})]})]})}):null},f=()=>{const[d,n]=c.useState([]),[x,r]=c.useState(!1),[p,u]=c.useState(null),t=async()=>{try{const s=await i.get("/api/products");n(s.data.products||[])}catch(s){console.error("Failed to load products",s)}},m=s=>{u(s),r(!0)},o=async s=>{if(window.confirm("Are you sure you want to delete this product?"))try{await i.delete(`/api/products/${s}`,{withCredentials:!0}),t()}catch(l){console.error("Error deleting product:",l)}};return c.useEffect(()=>{t()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Manage Products"}),e.jsx("button",{onClick:()=>{u(null),r(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded",children:"+ Add Product"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"Name"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Price"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Category"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(s=>{var l;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"border px-4 py-2",children:s.name}),e.jsxs("td",{className:"border px-4 py-2",children:["Rs ",s.price]}),e.jsx("td",{className:"border px-4 py-2",children:(l=s.category)==null?void 0:l.name}),e.jsxs("td",{className:"border px-4 py-2 space-x-2",children:[e.jsx("button",{onClick:()=>m(s),className:"px-3 py-1 bg-yellow-400 text-black rounded",children:"Edit"}),e.jsx("button",{onClick:()=>o(s.id),className:"px-3 py-1 bg-red-500 text-white rounded",children:"Delete"})]})]},s.id)})})]})}),x&&e.jsx(j,{product:p,onClose:()=>r(!1),onSuccess:()=>{t(),r(!1)}})]})};export{f as default};
